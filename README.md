# API í‚¤ ë°œê¸‰ ë°›ëŠ” ë°©ë²•

## ëª©ì°¨
1. https://aistudio.google.com/app/apikey ì ‘ì†
2. "Create API key" ë˜ëŠ” "API í‚¤ ë§Œë“¤ê¸°" ë²„íŠ¼ í´ë¦­
3. ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± ë˜ëŠ” ê¸°ì¡´ í”„ë¡œì íŠ¸ ì„ íƒ
4. ìƒì„±ëœ API í‚¤ ë³µì‚¬ (AIzaSy...ë¡œ ì‹œì‘)
5. .env íŒŒì¼ì— í‚¤ ì…ë ¥ (
    Google Gemini API
    GOOGLE_API_KEY=ì—¬ê¸°ì—_ë°œê¸‰ë°›ì€_API_í‚¤_ë¶™ì—¬ë„£ê¸°
)

## ì£¼ì˜ì‚¬í•­
1. API í‚¤ëŠ” ê¹ƒí—ˆë¸Œì— ì—…ë¡œë“œ í•˜ì§€ ë§ˆì„¸ìš”(ë³´ì•ˆ ë¬¸ì œ)
2. ê°ì ë³¸ì¸ì˜ API í‚¤ ë°œê¸‰í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”
3. ì›ë˜ .env íŒŒì¼ì€ ê³µìœ í•˜ë©´ ì•ˆ ë˜ëŠ”ë° ì´ë¯¸ ìš°ë¦¬ëŠ” ê³µìœ í•´ë²„ë ¸ì–´ìš” ê·¸ëŸ¬ë‹ˆê¹Œ API í‚¤ë§Œ ê°ì ê´€ë¦¬ ã„±ã„±

# ê³µê³µë¬¸ì„œ AI ì„œë¹„ìŠ¤ - ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

> Option 2: ëª¨ë†€ë¦¬ì‹ + RAG ê¸°ë°˜ ì¤‘ê¸‰ììš© êµ¬í˜„ ê°€ì´ë“œ

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì „ì²´ ì•„í‚¤í…ì²˜](#ì „ì²´-ì•„í‚¤í…ì²˜)
3. [ë ˆì´ì–´ë³„ ìƒì„¸ êµ¬ì¡°](#ë ˆì´ì–´ë³„-ìƒì„¸-êµ¬ì¡°)
4. [ë°ì´í„° í”Œë¡œìš°](#ë°ì´í„°-í”Œë¡œìš°)
5. [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
6. [ë””ë ‰í† ë¦¬ êµ¬ì¡°](#ë””ë ‰í† ë¦¬-êµ¬ì¡°)
7. [ì£¼ìš” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„](#ì£¼ìš”-ì»´í¬ë„ŒíŠ¸-êµ¬í˜„)

---

## ì‹œìŠ¤í…œ ê°œìš”

### í•µì‹¬ ê¸°ëŠ¥
- ğŸ“„ ë¬¸ì„œ ì—…ë¡œë“œ ë° íŒŒì‹± (PDF, HWP, DOCX, ì´ë¯¸ì§€)
- ğŸ¤– AI ê¸°ë°˜ ìë™ ìš”ì•½
- ğŸ¯ í–‰ë™ ì•ˆë‚´ ì¶”ì¶œ (ë‚ ì§œ, ê¸ˆì•¡, ë°©ë²•)
- ğŸ’¬ ë¬¸ì„œ ê¸°ë°˜ Q&A ì±—ë´‡
- âš¡ Redis ìºì‹±
- ğŸ” RAG (ê²€ìƒ‰ ì¦ê°• ìƒì„±)

### ì²˜ë¦¬ ìš©ëŸ‰ ëª©í‘œ
- **ì‚¬ìš©ì**: 1,000 ~ 10,000ëª…
- **ë™ì‹œ ì ‘ì†**: 100ëª…
- **ë¬¸ì„œ ì²˜ë¦¬**: ì›” 10,000ê±´
- **í‰ê·  ì‘ë‹µ ì‹œê°„**: 3ì´ˆ ì´ë‚´

---

## ì „ì²´ ì•„í‚¤í…ì²˜

### High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Client Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Web App    â”‚  â”‚  Mobile App  â”‚  â”‚   Admin Dashboard    â”‚  â”‚
â”‚  â”‚  (React.js)  â”‚  â”‚(React Native)â”‚  â”‚      (Next.js)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS (REST API)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Application Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              FastAPI Application (Python)                  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  API Routes â”‚  â”‚  Middleware â”‚  â”‚  Error Handler  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   /upload   â”‚  â”‚   - CORS    â”‚  â”‚   - Logging     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  /analyze   â”‚  â”‚   - Auth    â”‚  â”‚   - Sentry      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    /chat    â”‚  â”‚   - RateL   â”‚  â”‚                 â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Service Layer                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Document   â”‚  â”‚      AI      â”‚  â”‚       Action         â”‚  â”‚
â”‚  â”‚   Parser     â”‚  â”‚   Service    â”‚  â”‚      Extractor       â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                      â”‚  â”‚
â”‚  â”‚ â€¢ PDF Parser â”‚  â”‚ â€¢ LLM Client â”‚  â”‚ â€¢ NER (ë‚ ì§œ/ê¸ˆì•¡)     â”‚  â”‚
â”‚  â”‚ â€¢ HWP Parser â”‚  â”‚ â€¢ RAG Engine â”‚  â”‚ â€¢ Regex Patterns     â”‚  â”‚
â”‚  â”‚ â€¢ OCR Engine â”‚  â”‚ â€¢ Embeddings â”‚  â”‚ â€¢ Entity Linking     â”‚  â”‚
â”‚  â”‚ â€¢ Image Pre  â”‚  â”‚ â€¢ Summarizer â”‚  â”‚                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Data Layer                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL   â”‚  â”‚    Redis     â”‚  â”‚      MinIO/S3        â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                      â”‚  â”‚
â”‚  â”‚ â€¢ Documents  â”‚  â”‚ â€¢ Cache      â”‚  â”‚ â€¢ Original Files     â”‚  â”‚
â”‚  â”‚ â€¢ Users      â”‚  â”‚ â€¢ Sessions   â”‚  â”‚ â€¢ Processed Files    â”‚  â”‚
â”‚  â”‚ â€¢ Analytics  â”‚  â”‚ â€¢ Queue      â”‚  â”‚                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Vector DB   â”‚  â”‚          External APIs               â”‚    â”‚
â”‚  â”‚  (Pinecone/  â”‚  â”‚                                      â”‚    â”‚
â”‚  â”‚   Weaviate)  â”‚  â”‚  â€¢ OpenAI GPT-4                      â”‚    â”‚
â”‚  â”‚              â”‚  â”‚  â€¢ OpenAI Embeddings                 â”‚    â”‚
â”‚  â”‚ â€¢ Embeddings â”‚  â”‚  â€¢ (Optional) HyperCLOVA X           â”‚    â”‚
â”‚  â”‚ â€¢ Chunks     â”‚  â”‚                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë ˆì´ì–´ë³„ ìƒì„¸ êµ¬ì¡°

### 1. Client Layer (í”„ë¡ íŠ¸ì—”ë“œ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Web Application (React)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Components:                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FileUploader.tsx                â”‚  â”‚
â”‚  â”‚  â€¢ Drag & Drop                   â”‚  â”‚
â”‚  â”‚  â€¢ File validation               â”‚  â”‚
â”‚  â”‚  â€¢ Progress bar                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AnalysisResult.tsx              â”‚  â”‚
â”‚  â”‚  â€¢ Summary display               â”‚  â”‚
â”‚  â”‚  â€¢ Action cards                  â”‚  â”‚
â”‚  â”‚  â€¢ Key points list               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ChatInterface.tsx               â”‚  â”‚
â”‚  â”‚  â€¢ Message list                  â”‚  â”‚
â”‚  â”‚  â€¢ Input box                     â”‚  â”‚
â”‚  â”‚  â€¢ Typing indicator              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  Services:                              â”‚
â”‚  â€¢ API Client (Axios)                   â”‚
â”‚  â€¢ State Management (Zustand/Redux)    â”‚
â”‚  â€¢ Error Handler                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. Application Layer (FastAPI)

#### 2.1 API Routes êµ¬ì¡°

```
app/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ v1/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”‚
â”‚       â”œâ”€â”€ documents.py  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚   POST /upload           â”‚  Document ê´€ë ¨
â”‚       â”‚   GET  /{id}             â”‚  ì—”ë“œí¬ì¸íŠ¸
â”‚       â”‚   DELETE /{id}           â”‚
â”‚       â”‚                          â”‚
â”‚       â”œâ”€â”€ analyze.py  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚   POST /analyze          â”‚  Analysis ê´€ë ¨
â”‚       â”‚   GET  /status/{id}      â”‚  ì—”ë“œí¬ì¸íŠ¸
â”‚       â”‚                          â”‚
â”‚       â””â”€â”€ chat.py  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚           POST /chat              â”‚  Chat ê´€ë ¨
â”‚           GET  /history/{id}      â”‚  ì—”ë“œí¬ì¸íŠ¸
```

#### 2.2 ë¯¸ë“¤ì›¨ì–´ íŒŒì´í”„ë¼ì¸

```
Request
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CORS Middleware â”‚  â†’ Origin ì²´í¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rate Limiter     â”‚  â†’ IPë‹¹ ìš”ì²­ ì œí•œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Authentication   â”‚  â†’ (Optional) JWT ê²€ì¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Request Logger   â”‚  â†’ ìš”ì²­ ë¡œê¹…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Route Handler    â”‚  â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error Handler    â”‚  â†’ ì—ëŸ¬ ì²˜ë¦¬ & ë¡œê¹…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
      Response
```

---

### 3. Service Layer ìƒì„¸

#### 3.1 Document Parser Service

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Document Parser Service              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  Input: File (PDF/HWP/DOCX/Image)           â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. File Type Detection                â”‚ â”‚
â”‚  â”‚     â€¢ MIME type check                  â”‚ â”‚
â”‚  â”‚     â€¢ Extension validation             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Parser Selection                   â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  if PDF:                               â”‚ â”‚
â”‚  â”‚    â†’ PDFParser (pdfplumber)            â”‚ â”‚
â”‚  â”‚       â€¢ Text extraction                â”‚ â”‚
â”‚  â”‚       â€¢ Table extraction               â”‚ â”‚
â”‚  â”‚       â€¢ Layout analysis                â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  elif HWP:                             â”‚ â”‚
â”‚  â”‚    â†’ HWPParser (olefile/pyhwp)         â”‚ â”‚
â”‚  â”‚       â€¢ Binary parsing                 â”‚ â”‚
â”‚  â”‚       â€¢ Text decoding (UTF-16)         â”‚ â”‚
â”‚  â”‚       â€¢ Structure parsing              â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  elif DOCX:                            â”‚ â”‚
â”‚  â”‚    â†’ DOCXParser (python-docx)          â”‚ â”‚
â”‚  â”‚       â€¢ XML parsing                    â”‚ â”‚
â”‚  â”‚       â€¢ Paragraph extraction           â”‚ â”‚
â”‚  â”‚       â€¢ Table extraction               â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  elif Image:                           â”‚ â”‚
â”‚  â”‚    â†’ OCREngine (Tesseract)             â”‚ â”‚
â”‚  â”‚       â€¢ Image preprocessing            â”‚ â”‚
â”‚  â”‚       â€¢ OCR (Korean + English)         â”‚ â”‚
â”‚  â”‚       â€¢ Confidence scoring             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Text Cleaning                      â”‚ â”‚
â”‚  â”‚     â€¢ Whitespace normalization         â”‚ â”‚
â”‚  â”‚     â€¢ Special character removal        â”‚ â”‚
â”‚  â”‚     â€¢ Encoding fix                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  Output: Clean Text + Metadata              â”‚
â”‚  {                                           â”‚
â”‚    "text": "...",                            â”‚
â”‚    "page_count": 3,                          â”‚
â”‚    "has_tables": true,                       â”‚
â”‚    "confidence": 0.95                        â”‚
â”‚  }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 AI Service (RAG Engine)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  RAG (Retrieval-Augmented Generation)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Phase 1: Document Processing                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Text Splitting                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Original Document (5000 chars)                  â”‚ â”‚
â”‚  â”‚            â†“                                         â”‚ â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
â”‚  â”‚     â”‚ Chunk Splitter  â”‚                             â”‚ â”‚
â”‚  â”‚     â”‚ (500 chars,     â”‚                             â”‚ â”‚
â”‚  â”‚     â”‚  50 overlap)    â”‚                             â”‚ â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
â”‚  â”‚              â†“                                       â”‚ â”‚
â”‚  â”‚     Chunk 1 (0-500)                                 â”‚ â”‚
â”‚  â”‚     Chunk 2 (450-950)                               â”‚ â”‚
â”‚  â”‚     Chunk 3 (900-1400)                              â”‚ â”‚
â”‚  â”‚     ...                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Embedding Generation                             â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Each Chunk                                       â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     OpenAI Embeddings API                            â”‚ â”‚
â”‚  â”‚     (text-embedding-3-small)                         â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Vector [1536 dimensions]                         â”‚ â”‚
â”‚  â”‚     [0.123, -0.456, 0.789, ...]                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Vector Storage                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Vector Database (Pinecone/Weaviate)              â”‚ â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚     â”‚ document_id: "abc-123"               â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ chunk_index: 0                       â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ vector: [0.123, -0.456, ...]         â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ metadata: {                          â”‚        â”‚ â”‚
â”‚  â”‚     â”‚   page: 1,                           â”‚        â”‚ â”‚
â”‚  â”‚     â”‚   type: "ì„¸ê¸ˆê³ ì§€ì„œ"                  â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ }                                    â”‚        â”‚ â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â”‚  Phase 2: Query Processing                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Query Embedding                                  â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     User Query: "ì–¸ì œê¹Œì§€ ë‚©ë¶€í•´ì•¼ í•´?"               â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     OpenAI Embeddings API                            â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Query Vector [1536 dimensions]                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Similarity Search                                â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Vector DB Search (Cosine Similarity)             â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Top 5 Most Similar Chunks:                       â”‚ â”‚
â”‚  â”‚     1. Chunk #7  (similarity: 0.92)                  â”‚ â”‚
â”‚  â”‚        "ë‚©ë¶€ ê¸°í•œì€ 2025ë…„ 10ì›” 20ì¼ê¹Œì§€..."           â”‚ â”‚
â”‚  â”‚     2. Chunk #3  (similarity: 0.87)                  â”‚ â”‚
â”‚  â”‚        "ë‚©ë¶€ ê¸ˆì•¡ì€ 130,000ì›ì…ë‹ˆë‹¤..."               â”‚ â”‚
â”‚  â”‚     ...                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Context Augmentation                             â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Retrieved Chunks + Original Query                â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Augmented Prompt:                                â”‚ â”‚
â”‚  â”‚     """                                              â”‚ â”‚
â”‚  â”‚     ë‹¤ìŒ ë¬¸ì„œ ë‚´ìš©ì„ ì°¸ê³ í•˜ì—¬ ì§ˆë¬¸ì— ë‹µí•˜ì„¸ìš”:          â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     ë¬¸ì„œ ë‚´ìš©:                                        â”‚ â”‚
â”‚  â”‚     - ë‚©ë¶€ ê¸°í•œì€ 2025ë…„ 10ì›” 20ì¼ê¹Œì§€...            â”‚ â”‚
â”‚  â”‚     - ë‚©ë¶€ ê¸ˆì•¡ì€ 130,000ì›ì…ë‹ˆë‹¤...                 â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     ì§ˆë¬¸: ì–¸ì œê¹Œì§€ ë‚©ë¶€í•´ì•¼ í•´?                       â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     ë‹µë³€:                                            â”‚ â”‚
â”‚  â”‚     """                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4. LLM Generation                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     OpenAI GPT-4                                     â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     "2025ë…„ 10ì›” 20ì¼ê¹Œì§€ ë‚©ë¶€í•˜ì…”ì•¼ í•©ë‹ˆë‹¤."         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3 Action Extractor Service

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Action Extractor Service             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  Input: Document Text                        â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Named Entity Recognition (NER)    â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Text: "2025ë…„ 10ì›” 20ì¼ê¹Œì§€ 130,000ì›  â”‚ â”‚
â”‚  â”‚         ì„ ì§€ë°©ì„¸ì…ê³„ì¢Œë¡œ ë‚©ë¶€í•˜ì„¸ìš”"    â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Regex Patterns:                       â”‚ â”‚
â”‚  â”‚  â€¢ Date:  \d{4}ë…„\s*\d{1,2}ì›”\s*\d{1,2}ì¼â”‚ â”‚
â”‚  â”‚  â€¢ Amount: \d{1,3}(,\d{3})*ì›           â”‚ â”‚
â”‚  â”‚  â€¢ Phone: \d{2,3}-\d{3,4}-\d{4}         â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Extracted:                            â”‚ â”‚
â”‚  â”‚  â€¢ DATE: "2025ë…„ 10ì›” 20ì¼"             â”‚ â”‚
â”‚  â”‚  â€¢ AMOUNT: "130,000ì›"                  â”‚ â”‚
â”‚  â”‚  â€¢ ACCOUNT: "ì§€ë°©ì„¸ì…ê³„ì¢Œ"              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Normalization                      â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ Date â†’ ISO format                   â”‚ â”‚
â”‚  â”‚    "2025ë…„ 10ì›” 20ì¼" â†’ "2025-10-20"   â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ Amount â†’ Number                     â”‚ â”‚
â”‚  â”‚    "130,000ì›" â†’ 130000                â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ Phone â†’ Standard format             â”‚ â”‚
â”‚  â”‚    "02-123-4567" â†’ "02-123-4567"       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Relationship Extraction            â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Link entities:                        â”‚ â”‚
â”‚  â”‚  â€¢ deadline â† DATE                     â”‚ â”‚
â”‚  â”‚  â€¢ amount â† AMOUNT                     â”‚ â”‚
â”‚  â”‚  â€¢ method â† ACCOUNT                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4. Action Builder                     â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Template:                             â”‚ â”‚
â”‚  â”‚  "{method}ë¡œ {amount}ì›ì„               â”‚ â”‚
â”‚  â”‚   {deadline}ê¹Œì§€ ë‚©ë¶€í•˜ì„¸ìš”"            â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Result:                               â”‚ â”‚
â”‚  â”‚  "ì§€ë°©ì„¸ì…ê³„ì¢Œë¡œ 130,000ì›ì„             â”‚ â”‚
â”‚  â”‚   2025-10-20ê¹Œì§€ ë‚©ë¶€í•˜ì„¸ìš”"            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚  Output: Structured Action                   â”‚
â”‚  {                                           â”‚
â”‚    "deadline": "2025-10-20",                 â”‚
â”‚    "amount": 130000,                         â”‚
â”‚    "action": "...",                          â”‚
â”‚    "method": "ì§€ë°©ì„¸ì…ê³„ì¢Œ"                   â”‚
â”‚  }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë°ì´í„° í”Œë¡œìš°

### ì „ì²´ ìš”ì²­ íë¦„ (Upload â†’ Analyze)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ 1. íŒŒì¼ ì„ íƒ
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend (React)                    â”‚
â”‚                                             â”‚
â”‚  â€¢ File validation (í¬ê¸°, í˜•ì‹)              â”‚
â”‚  â€¢ FormData ìƒì„±                             â”‚
â”‚  â€¢ Progress bar í‘œì‹œ                         â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 2. POST /documents/upload
     â”‚    (multipart/form-data)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      API Gateway (FastAPI)                  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Middleware Pipeline                   â”‚ â”‚
â”‚  â”‚  1. CORS check                         â”‚ â”‚
â”‚  â”‚  2. Rate limit (IPë‹¹ 100req/hour)      â”‚ â”‚
â”‚  â”‚  3. Request logging                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 3. documents.upload_handler()
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Document Service                       â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Validation                         â”‚ â”‚
â”‚  â”‚     â€¢ File size < 10MB?                â”‚ â”‚
â”‚  â”‚     â€¢ Extension in allowed list?       â”‚ â”‚
â”‚  â”‚     â€¢ MIME type check                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. File Storage                       â”‚ â”‚
â”‚  â”‚     â€¢ Generate UUID                    â”‚ â”‚
â”‚  â”‚     â€¢ Save to /tmp/uploads/{uuid}.ext  â”‚ â”‚
â”‚  â”‚     â€¢ (Optional) Upload to S3          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Database Record                    â”‚ â”‚
â”‚  â”‚     INSERT INTO documents              â”‚ â”‚
â”‚  â”‚       (id, filename, path, status)     â”‚ â”‚
â”‚  â”‚     VALUES (uuid, name, path, 'uploaded')â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 4. Return document_id
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend                            â”‚
â”‚                                             â”‚
â”‚  â€¢ Store document_id                        â”‚
â”‚  â€¢ Enable "ë¶„ì„í•˜ê¸°" button                  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 5. User clicks "ë¶„ì„í•˜ê¸°"
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend                            â”‚
â”‚                                             â”‚
â”‚  â€¢ Show loading spinner                     â”‚
â”‚  â€¢ POST /analyze { document_id }            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 6. POST /analyze
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      API Gateway                            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 7. analyze.analyze_handler()
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Analysis Orchestrator                  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 1: Load Document                 â”‚ â”‚
â”‚  â”‚  â€¢ SELECT * FROM documents             â”‚ â”‚
â”‚  â”‚    WHERE id = {document_id}            â”‚ â”‚
â”‚  â”‚  â€¢ Check status != 'processing'        â”‚ â”‚
â”‚  â”‚  â€¢ UPDATE status = 'processing'        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 2: Cache Check                   â”‚ â”‚
â”‚  â”‚  â€¢ hash = md5(file_content)            â”‚ â”‚
â”‚  â”‚  â€¢ cached = redis.get(f"doc:{hash}")   â”‚ â”‚
â”‚  â”‚  â€¢ if cached: return cached            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“ (cache miss)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 3: Parse Document                â”‚ â”‚
â”‚  â”‚  â€¢ DocumentParser.parse(file_path)     â”‚ â”‚
â”‚  â”‚  â€¢ Get clean text                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 4: RAG Processing                â”‚ â”‚
â”‚  â”‚  â€¢ Split text into chunks              â”‚ â”‚
â”‚  â”‚  â€¢ Generate embeddings                 â”‚ â”‚
â”‚  â”‚  â€¢ Store in vector DB                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 5: LLM Analysis                  â”‚ â”‚
â”‚  â”‚  Parallel execution:                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Summarize  â”‚  â”‚ Extract Actions  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ (GPT-4)    â”‚  â”‚ (NER + GPT)      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 6: Save Results                  â”‚ â”‚
â”‚  â”‚  â€¢ UPDATE documents SET                â”‚ â”‚
â”‚  â”‚      analysis_result = {result},       â”‚ â”‚
â”‚  â”‚      status = 'completed'              â”‚ â”‚
â”‚  â”‚  â€¢ redis.set(cache_key, result, ex=86400)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 8. Return analysis result
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend                            â”‚
â”‚                                             â”‚
â”‚  â€¢ Hide loading spinner                     â”‚
â”‚  â€¢ Display summary                          â”‚
â”‚  â€¢ Show action cards                        â”‚
â”‚  â€¢ Enable chat interface                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì±—ë´‡ ëŒ€í™” í”Œë¡œìš°

```
User Question: "ì–¸ì œê¹Œì§€ ë‚©ë¶€í•´ì•¼ í•´?"
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend (Chat Interface)      â”‚
â”‚  â€¢ Add message to chat history  â”‚
â”‚  â€¢ POST /chat                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chat Service                   â”‚
â”‚                                 â”‚
â”‚  1. Question Embedding          â”‚
â”‚     â†“                           â”‚
â”‚  2. Vector Similarity Search    â”‚
â”‚     Query Vector DB             â”‚
â”‚     â†“                           â”‚
â”‚  3. Get Top 5 Relevant Chunks   â”‚
â”‚     Chunk #7: "ë‚©ë¶€ ê¸°í•œì€..."   â”‚
â”‚     Chunk #3: "ë‚©ë¶€ ê¸ˆì•¡ì€..."   â”‚
â”‚     â†“                           â”‚
â”‚  4. Build Augmented Prompt      â”‚
â”‚     Context: [chunks]           â”‚
â”‚     History: [past messages]    â”‚
â”‚     Question: "ì–¸ì œê¹Œì§€..."      â”‚
â”‚     â†“                           â”‚
â”‚  5. LLM Generation (GPT-4)      â”‚
â”‚     â†“                           â”‚
â”‚  6. Answer with Source          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
      Response
      {
        "answer": "2025ë…„ 10ì›” 20ì¼ê¹Œì§€...",
        "source": "document",
        "confidence": 0.95
      }
```

---

## ê¸°ìˆ  ìŠ¤íƒ

### Backend Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Backend Layer                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  Framework:                              â”‚
â”‚  â€¢ FastAPI 0.104+         (Web Framework)â”‚
â”‚  â€¢ Pydantic 2.0+          (Validation)   â”‚
â”‚  â€¢ Uvicorn                (ASGI Server)  â”‚
â”‚                                          â”‚
â”‚  Document Processing:                    â”‚
â”‚  â€¢ pdfplumber             (PDF parsing)  â”‚
â”‚  â€¢ python-docx            (DOCX parsing) â”‚
â”‚  â€¢ olefile / pyhwp        (HWP parsing)  â”‚
â”‚  â€¢ pytesseract            (OCR)          â”‚
â”‚  â€¢ Pillow, OpenCV         (Image proc)   â”‚
â”‚                                          â”‚
â”‚  AI/ML:                                  â”‚
â”‚  â€¢ openai 1.0+            (GPT-4 API)    â”‚
â”‚  â€¢ langchain 0.1+         (RAG framework)â”‚
â”‚  â€¢ sentence-transformers  (Embeddings)   â”‚
â”‚  â€¢ tiktoken               (Token count)  â”‚
â”‚                                          â”‚
â”‚  Database:                               â”‚
â”‚  â€¢ SQLAlchemy 2.0+        (ORM)          â”‚
â”‚  â€¢ psycopg2-binary        (PostgreSQL)   â”‚
â”‚  â€¢ redis                  (Caching)      â”‚
â”‚  â€¢ pinecone-client        (Vector DB)    â”‚
â”‚                                          â”‚
â”‚  Utilities:                              â”‚
â”‚  â€¢ python-multipart       (File upload)  â”‚
â”‚  â€¢ python-jose            (JWT)          â”‚
â”‚  â€¢ passlib                (Password hash)â”‚
â”‚  â€¢ python-dotenv          (Env vars)     â”‚
â”‚  â€¢ aiofiles               (Async I/O)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Infrastructure Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Infrastructure                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  Databases:                              â”‚
â”‚  â€¢ PostgreSQL 15          (Main DB)      â”‚
â”‚  â€¢ Redis 7                (Cache/Queue)  â”‚
â”‚  â€¢ Pinecone / Weaviate    (Vector DB)    â”‚
â”‚                                          â”‚
â”‚  Storage:                                â”‚
â”‚  â€¢ Local FS / MinIO       (Dev)          â”‚
â”‚  â€¢ AWS S3 / GCS           (Production)   â”‚
â”‚                                          â”‚
â”‚  Deployment:                             â”‚
â”‚  â€¢ Docker                 (Containerize) â”‚
â”‚  â€¢ Docker Compose         (Orchestration)â”‚
â”‚  â€¢ Nginx                  (Reverse proxy)â”‚
â”‚                                          â”‚
â”‚  Monitoring:                             â”‚
â”‚  â€¢ Sentry                 (Error track)  â”‚
â”‚  â€¢ Prometheus             (Metrics)      â”‚
â”‚  â€¢ Grafana                (Visualization)â”‚
â”‚                                          â”‚
â”‚  CI/CD:                                  â”‚
â”‚  â€¢ GitHub Actions         (CI/CD)        â”‚
â”‚  â€¢ Pre-commit             (Git hooks)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

### ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
doc-ai-backend/
â”‚
â”œâ”€â”€ app/                          # ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                   # FastAPI ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ config.py                 # ì„¤ì • (í™˜ê²½ë³€ìˆ˜ ë“±)
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                      # API ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ deps.py               # ê³µí†µ ì˜ì¡´ì„±
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ documents.py      # ë¬¸ì„œ ì—…ë¡œë“œ/ì¡°íšŒ
â”‚   â”‚       â”œâ”€â”€ analyze.py        # ë¬¸ì„œ ë¶„ì„
â”‚   â”‚       â””â”€â”€ chat.py           # ì±—ë´‡ Q&A
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                     # í•µì‹¬ ê¸°ëŠ¥
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ security.py           # ì¸ì¦/ë³´ì•ˆ
â”‚   â”‚   â”œâ”€â”€ middleware.py         # ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â””â”€â”€ exceptions.py         # ì»¤ìŠ¤í…€ ì˜ˆì™¸
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ document_parser/     # ë¬¸ì„œ íŒŒì‹±
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py          # ì¶”ìƒ í´ë˜ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ pdf_parser.py
â”‚   â”‚   â”‚   â”œâ”€â”€ hwp_parser.py
â”‚   â”‚   â”‚   â”œâ”€â”€ docx_parser.py
â”‚   â”‚   â”‚   â””â”€â”€ image_parser.py  # OCR
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ llm/                  # LLM ê´€ë ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ client.py        # OpenAI í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts.py       # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚   â”‚   â”‚   â””â”€â”€ smart_router.py  # ëª¨ë¸ ì„ íƒ ë¡œì§
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ rag/                  # RAG ì‹œìŠ¤í…œ
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ embeddings.py    # ì„ë² ë”© ìƒì„±
â”‚   â”‚   â”‚   â”œâ”€â”€ vector_store.py  # ë²¡í„° DB ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ retriever.py     # ê²€ìƒ‰ ë¡œì§
â”‚   â”‚   â”‚   â””â”€â”€ chain.py         # RAG ì²´ì¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ extractor/            # ì •ë³´ ì¶”ì¶œ
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ner.py           # NER (ê°œì²´ëª… ì¸ì‹)
â”‚   â”‚   â”‚   â”œâ”€â”€ patterns.py      # Regex íŒ¨í„´
â”‚   â”‚   â”‚   â””â”€â”€ action_builder.py
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ cache/                # ìºì‹±
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ redis_cache.py
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                   # DB ëª¨ë¸ (SQLAlchemy)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                  # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â”œâ”€â”€ analyze.py
â”‚   â”‚   â””â”€â”€ chat.py
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                       # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â””â”€â”€ session.py
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ file_handler.py
â”‚       â”œâ”€â”€ hash.py
â”‚       â””â”€â”€ logger.py
â”‚
â”œâ”€â”€ tests/                        # í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py               # pytest ì„¤ì •
â”‚   â”œâ”€â”€ test_api/
â”‚   â”‚   â”œâ”€â”€ test_documents.py
â”‚   â”‚   â”œâ”€â”€ test_analyze.py
â”‚   â”‚   â””â”€â”€ test_chat.py
â”‚   â”œâ”€â”€ test_services/
â”‚   â”‚   â”œâ”€â”€ test_parser.py
â”‚   â”‚   â”œâ”€â”€ test_llm.py
â”‚   â”‚   â””â”€â”€ test_rag.py
â”‚   â””â”€â”€ fixtures/
â”‚       â”œâ”€â”€ sample.pdf
â”‚       â”œâ”€â”€ sample.hwp
â”‚       â””â”€â”€ sample.jpg
â”‚
â”œâ”€â”€ alembic/                      # DB ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ versions/
â”‚   â”œâ”€â”€ env.py
â”‚   â””â”€â”€ alembic.ini
â”‚
â”œâ”€â”€ scripts/                      # ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ init_db.py
â”‚   â”œâ”€â”€ seed_data.py
â”‚   â””â”€â”€ migrate.sh
â”‚
â”œâ”€â”€ docs/                         # ë¬¸ì„œ
â”‚   â”œâ”€â”€ API_SPECIFICATION.md
â”‚   â”œâ”€â”€ ARCHITECTURE.md
â”‚   â””â”€â”€ DEPLOYMENT.md
â”‚
â”œâ”€â”€ .github/                      # GitHub Actions
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml
â”‚       â””â”€â”€ deploy.yml
â”‚
â”œâ”€â”€ docker/                       # Docker íŒŒì¼
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ Dockerfile.dev
â”‚   â””â”€â”€ nginx.conf
â”‚
â”œâ”€â”€ .env.example                  # í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ .gitignore
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ docker-compose.dev.yml
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ requirements-dev.txt
â”œâ”€â”€ pyproject.toml               # Python í”„ë¡œì íŠ¸ ì„¤ì •
â”œâ”€â”€ pytest.ini
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE
```

---

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

### 1. main.py (FastAPI ì•±)

```python
# app/main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager

from app.config import settings
from app.api.v1 import documents, analyze, chat
from app.core.middleware import LoggingMiddleware, RateLimitMiddleware
from app.db.session import engine
from app.models.base import Base


@asynccontextmanager
async def lifespan(app: FastAPI):
    """ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘/ì¢…ë£Œ ì´ë²¤íŠ¸"""
    # Startup
    print("ğŸš€ Starting application...")
    # DB í…Œì´ë¸” ìƒì„± (í”„ë¡œë•ì…˜ì—ì„œëŠ” Alembic ì‚¬ìš©)
    Base.metadata.create_all(bind=engine)
    
    yield
    
    # Shutdown
    print("ğŸ‘‹ Shutting down application...")


# FastAPI ì•± ìƒì„±
app = FastAPI(
    title=settings.PROJECT_NAME,
    version="1.0.0",
    openapi_url=f"{settings.API_V1_STR}/openapi.json",
    lifespan=lifespan
)

# CORS ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.ALLOWED_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# ì»¤ìŠ¤í…€ ë¯¸ë“¤ì›¨ì–´
app.add_middleware(LoggingMiddleware)
app.add_middleware(RateLimitMiddleware)

# ë¼ìš°í„° ë“±ë¡
app.include_router(
    documents.router,
    prefix=f"{settings.API_V1_STR}/documents",
    tags=["documents"]
)
app.include_router(
    analyze.router,
    prefix=f"{settings.API_V1_STR}",
    tags=["analyze"]
)
app.include_router(
    chat.router,
    prefix=f"{settings.API_V1_STR}",
    tags=["chat"]
)


@app.get("/health")
async def health_check():
    """í—¬ìŠ¤ ì²´í¬"""
    return {
        "status": "healthy",
        "version": "1.0.0"
    }


if __name__ == "__main__":
    import uvicorn
    uvicorn.run(
        "app.main:app",
        host="0.0.0.0",
        port=8000,
        reload=True
    )
```

### 2. config.py (í™˜ê²½ ì„¤ì •)

```python
# app/config.py
from pydantic_settings import BaseSettings
from typing import List


class Settings(BaseSettings):
    # API
    PROJECT_NAME: str = "Public Document AI"
    API_V1_STR: str = "/api/v1"
    ALLOWED_ORIGINS: List[str] = ["http://localhost:3000", "http://localhost:3001"]
    
    # OpenAI
    OPENAI_API_KEY: str
    OPENAI_MODEL_DEFAULT: str = "gpt-4o-mini"
    OPENAI_MODEL_PREMIUM: str = "gpt-4o"
    
    # Database
    DATABASE_URL: str = "postgresql://postgres:password@localhost:5432/docai"
    
    # Redis
    REDIS_URL: str = "redis://localhost:6379"
    
    # Vector DB
    PINECONE_API_KEY: str = ""
    PINECONE_ENVIRONMENT: str = ""
    PINECONE_INDEX: str = "doc-embeddings"
    
    # File Upload
    UPLOAD_DIR: str = "/tmp/uploads"
    MAX_FILE_SIZE: int = 10 * 1024 * 1024  # 10MB
    ALLOWED_EXTENSIONS: set = {".pdf", ".hwp", ".docx", ".jpg", ".jpeg", ".png"}
    
    # Cache
    CACHE_TTL: int = 86400  # 24 hours
    
    # Logging
    LOG_LEVEL: str = "INFO"
    
    # Sentry (Optional)
    SENTRY_DSN: str = ""
    
    class Config:
        env_file = ".env"
        case_sensitive = True


settings = Settings()
```

### 3. Document Parser Service

```python
# app/services/document_parser/pdf_parser.py
import pdfplumber
from typing import Dict, Any
from pathlib import Path


class PDFParser:
    """PDF ë¬¸ì„œ íŒŒì„œ"""
    
    async def parse(self, file_path: str) -> Dict[str, Any]:
        """
        PDF íŒŒì¼ì„ íŒŒì‹±í•˜ì—¬ í…ìŠ¤íŠ¸ ì¶”ì¶œ
        
        Args:
            file_path: PDF íŒŒì¼ ê²½ë¡œ
            
        Returns:
            {
                "text": "ì¶”ì¶œëœ í…ìŠ¤íŠ¸",
                "page_count": 3,
                "has_tables": True,
                "tables": [...]
            }
        """
        text = ""
        tables = []
        
        with pdfplumber.open(file_path) as pdf:
            page_count = len(pdf.pages)
            
            for page_num, page in enumerate(pdf.pages, 1):
                # í…ìŠ¤íŠ¸ ì¶”ì¶œ
                page_text = page.extract_text()
                if page_text:
                    text += f"\n--- Page {page_num} ---\n"
                    text += page_text
                
                # í‘œ ì¶”ì¶œ
                page_tables = page.extract_tables()
                if page_tables:
                    for table in page_tables:
                        tables.append({
                            "page": page_num,
                            "data": table
                        })
                        
                        # í‘œë¥¼ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ì¶”ê°€
                        for row in table:
                            if row:
                                text += "\n" + " | ".join([str(cell) if cell else "" for cell in row])
        
        return {
            "text": text.strip(),
            "page_count": page_count,
            "has_tables": len(tables) > 0,
            "tables": tables,
            "metadata": {
                "format": "pdf",
                "parser": "pdfplumber"
            }
        }
```

### 4. RAG Engine

```python
# app/services/rag/chain.py
from typing import Dict, Any, List
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings, ChatOpenAI
from langchain_community.vectorstores import Pinecone as LangchainPinecone
from langchain.chains import RetrievalQA
import pinecone

from app.config import settings


class RAGEngine:
    """RAG (ê²€ìƒ‰ ì¦ê°• ìƒì„±) ì—”ì§„"""
    
    def __init__(self):
        # Embeddings ëª¨ë¸
        self.embeddings = OpenAIEmbeddings(
            openai_api_key=settings.OPENAI_API_KEY,
            model="text-embedding-3-small"
        )
        
        # Pinecone ì´ˆê¸°í™”
        pinecone.init(
            api_key=settings.PINECONE_API_KEY,
            environment=settings.PINECONE_ENVIRONMENT
        )
        
        # Vector Store
        self.vector_store = LangchainPinecone(
            index_name=settings.PINECONE_INDEX,
            embedding=self.embeddings
        )
        
        # LLM
        self.llm = ChatOpenAI(
            openai_api_key=settings.OPENAI_API_KEY,
            model_name=settings.OPENAI_MODEL_DEFAULT,
            temperature=0.3
        )
    
    async def process_document(
        self, 
        text: str, 
        document_id: str
    ) -> None:
        """
        ë¬¸ì„œë¥¼ ì²˜ë¦¬í•˜ì—¬ Vector DBì— ì €ì¥
        
        Args:
            text: ë¬¸ì„œ í…ìŠ¤íŠ¸
            document_id: ë¬¸ì„œ ID
        """
        # 1. í…ìŠ¤íŠ¸ ë¶„í• 
        text_splitter = RecursiveCharacterTextSplitter(
            chunk_size=500,
            chunk_overlap=50,
            length_function=len,
        )
        chunks = text_splitter.split_text(text)
        
        # 2. ë©”íƒ€ë°ì´í„° ì¶”ê°€
        documents = []
        for i, chunk in enumerate(chunks):
            documents.append({
                "text": chunk,
                "metadata": {
                    "document_id": document_id,
                    "chunk_index": i,
                    "total_chunks": len(chunks)
                }
            })
        
        # 3. Vector DBì— ì €ì¥
        texts = [doc["text"] for doc in documents]
        metadatas = [doc["metadata"] for doc in documents]
        
        self.vector_store.add_texts(
            texts=texts,
            metadatas=metadatas
        )
    
    async def query(
        self, 
        question: str,
        document_id: str,
        k: int = 5
    ) -> Dict[str, Any]:
        """
        ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ ìƒì„±
        
        Args:
            question: ì‚¬ìš©ì ì§ˆë¬¸
            document_id: ë¬¸ì„œ ID
            k: ê²€ìƒ‰í•  chunk ê°œìˆ˜
            
        Returns:
            {
                "answer": "ë‹µë³€",
                "sources": [...],
                "confidence": 0.95
            }
        """
        # 1. Retriever ìƒì„± (íŠ¹ì • ë¬¸ì„œë§Œ ê²€ìƒ‰)
        retriever = self.vector_store.as_retriever(
            search_kwargs={
                "k": k,
                "filter": {"document_id": document_id}
            }
        )
        
        # 2. QA Chain ìƒì„±
        qa_chain = RetrievalQA.from_chain_type(
            llm=self.llm,
            chain_type="stuff",
            retriever=retriever,
            return_source_documents=True
        )
        
        # 3. ì§ˆë¬¸ ì‹¤í–‰
        result = qa_chain.invoke({"query": question})
        
        # 4. ì‹ ë¢°ë„ ê³„ì‚° (ê°„ë‹¨í•œ íœ´ë¦¬ìŠ¤í‹±)
        confidence = self._calculate_confidence(
            result["source_documents"]
        )
        
        return {
            "answer": result["result"],
            "sources": [
                {
                    "text": doc.page_content,
                    "chunk_index": doc.metadata["chunk_index"]
                }
                for doc in result["source_documents"]
            ],
            "confidence": confidence
        }
    
    def _calculate_confidence(
        self, 
        source_docs: List
    ) -> float:
        """ì‹ ë¢°ë„ ê³„ì‚°"""
        if not source_docs:
            return 0.0
        
        # ê²€ìƒ‰ëœ ë¬¸ì„œê°€ ë§ì„ìˆ˜ë¡ ì‹ ë¢°ë„ ë†’ìŒ
        # ê°„ë‹¨í•œ íœ´ë¦¬ìŠ¤í‹±: min(ê²€ìƒ‰ëœ ë¬¸ì„œ ìˆ˜ / 5, 1.0)
        return min(len(source_docs) / 5.0, 1.0)
```

### 5. API Route ì˜ˆì‹œ

```python
# app/api/v1/analyze.py
from fastapi import APIRouter, HTTPException, Depends, BackgroundTasks
from sqlalchemy.orm import Session
import json

from app.db.session import get_db
from app.models.document import Document
from app.services.document_parser import DocumentParserFactory
from app.services.llm.client import LLMClient
from app.services.rag.chain import RAGEngine
from app.services.extractor.action_builder import ActionExtractor
from app.services.cache.redis_cache import RedisCache
from app.schemas.analyze import AnalyzeRequest, AnalyzeResponse


router = APIRouter()
rag_engine = RAGEngine()
llm_client = LLMClient()
action_extractor = ActionExtractor()
cache = RedisCache()


@router.post("/analyze", response_model=AnalyzeResponse)
async def analyze_document(
    request: AnalyzeRequest,
    background_tasks: BackgroundTasks,
    db: Session = Depends(get_db)
):
    """
    ë¬¸ì„œ ë¶„ì„
    
    1. ë¬¸ì„œ ì¡°íšŒ
    2. ìºì‹œ í™•ì¸
    3. íŒŒì‹±
    4. RAG ì²˜ë¦¬
    5. LLM ë¶„ì„
    6. ê²°ê³¼ ì €ì¥
    """
    
    # 1. ë¬¸ì„œ ì¡°íšŒ
    document = db.query(Document).filter(
        Document.id == request.document_id
    ).first()
    
    if not document:
        raise HTTPException(
            status_code=404,
            detail={
                "error": "ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
                "code": "DOCUMENT_NOT_FOUND"
            }
        )
    
    # 2. ìºì‹œ í™•ì¸
    with open(document.file_path, 'rb') as f:
        file_content = f.read()
    
    cache_key = cache.generate_key(file_content)
    cached_result = await cache.get(cache_key)
    
    if cached_result:
        return AnalyzeResponse(**cached_result)
    
    # 3. ìƒíƒœ ì—…ë°ì´íŠ¸
    document.status = "processing"
    db.commit()
    
    try:
        # 4. ë¬¸ì„œ íŒŒì‹±
        parser = DocumentParserFactory.get_parser(document.file_type)
        parsed = await parser.parse(document.file_path)
        text = parsed["text"]
        
        # 5. RAG ì²˜ë¦¬ (ë°±ê·¸ë¼ìš´ë“œ)
        background_tasks.add_task(
            rag_engine.process_document,
            text,
            document.id
        )
        
        # 6. LLM ë¶„ì„ (ë³‘ë ¬)
        import asyncio
        
        summary_task = llm_client.summarize(text)
        actions_task = action_extractor.extract(text)
        
        summary, actions = await asyncio.gather(
            summary_task,
            actions_task
        )
        
        # 7. ê²°ê³¼ ì¡°í•©
        result = {
            "document_id": document.id,
            "summary": summary["summary"],
            "document_type": summary["document_type"],
            "importance": summary["importance"],
            "key_points": summary["key_points"],
            "actions": actions,
            "metadata": {
                "tokens_used": summary.get("tokens_used", 0),
                "model_used": summary.get("model_used", ""),
                "processing_time": 0  # TODO: ì‹¤ì œ ì‹œê°„ ì¸¡ì •
            }
        }
        
        # 8. DB ì €ì¥
        document.status = "completed"
        document.analysis_result = json.dumps(result, ensure_ascii=False)
        document.extracted_text = text
        db.commit()
        
        # 9. ìºì‹œ ì €ì¥ (24ì‹œê°„)
        await cache.set(cache_key, result, ttl=86400)
        
        return AnalyzeResponse(**result)
        
    except Exception as e:
        # ì—ëŸ¬ ì²˜ë¦¬
        document.status = "failed"
        document.error_message = str(e)
        db.commit()
        
        raise HTTPException(
            status_code=500,
            detail={
                "error": "ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",
                "code": "ANALYSIS_FAILED"
            }
        )
```

---

## ì„±ëŠ¥ ìµœì í™” í¬ì¸íŠ¸

### 1. ìºì‹± ì „ëµ

```python
# 3ë‹¨ê³„ ìºì‹±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Application     â”‚  â†’ Redis (ë¶„ì„ ê²°ê³¼)
â”‚     Cache           â”‚     TTL: 24ì‹œê°„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Database        â”‚  â†’ PostgreSQL 
â”‚     Query Cache     â”‚     (ORM ë ˆë²¨)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. CDN Cache       â”‚  â†’ CloudFlare
â”‚     (Static files)  â”‚     (ì´ë¯¸ì§€, CSS, JS)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ë¹„ë™ê¸° ì²˜ë¦¬

```python
# ë³‘ë ¬ ì²˜ë¦¬ë¡œ ì†ë„ í–¥ìƒ
import asyncio

async def analyze_document(text):
    # ë™ì‹œ ì‹¤í–‰
    summary, actions, embeddings = await asyncio.gather(
        summarize(text),      # 3ì´ˆ
        extract_actions(text), # 2ì´ˆ
        generate_embeddings(text) # 4ì´ˆ
    )
    # ì´ ì†Œìš” ì‹œê°„: 4ì´ˆ (ìµœëŒ€ê°’)
    # vs ìˆœì°¨ ì‹¤í–‰: 9ì´ˆ
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤

```sql
-- ìì£¼ ì¡°íšŒë˜ëŠ” ì»¬ëŸ¼ ì¸ë±ìŠ¤
CREATE INDEX idx_document_status ON documents(status);
CREATE INDEX idx_document_created ON documents(created_at DESC);

-- ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX idx_document_status_created 
ON documents(status, created_at DESC);
```

---

## ëª¨ë‹ˆí„°ë§ & ë¡œê¹…

### ë¡œê¹… êµ¬ì¡°

```python
# app/utils/logger.py
import logging
from pythonjsonlogger import jsonlogger

# JSON í˜•ì‹ ë¡œê·¸
logHandler = logging.StreamHandler()
formatter = jsonlogger.JsonFormatter(
    '%(timestamp)s %(level)s %(name)s %(message)s'
)
logHandler.setFormatter(formatter)

logger = logging.getLogger()
logger.addHandler(logHandler)
logger.setLevel(logging.INFO)

# ì‚¬ìš©
logger.info(
    "Document analyzed",
    extra={
        "document_id": "abc-123",
        "processing_time": 3.2,
        "tokens_used": 1250
    }
)
```

### ë©”íŠ¸ë¦­ ìˆ˜ì§‘

```python
# Prometheus ë©”íŠ¸ë¦­
from prometheus_client import Counter, Histogram

# ìš”ì²­ ì¹´ìš´í„°
request_count = Counter(
    'api_requests_total',
    'Total API requests',
    ['method', 'endpoint', 'status']
)

# ì²˜ë¦¬ ì‹œê°„ íˆìŠ¤í† ê·¸ë¨
processing_time = Histogram(
    'document_processing_seconds',
    'Document processing time'
)

# ì‚¬ìš©
with processing_time.time():
    result = await analyze_document(doc_id)
```

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. ì…ë ¥ ê²€ì¦

```python
# Pydanticìœ¼ë¡œ ìë™ ê²€ì¦
class UploadFile(BaseModel):
    filename: str = Field(..., max_length=255)
    file_size: int = Field(..., le=10*1024*1024)  # 10MB
    file_type: str = Field(..., regex=r'\.(pdf|hwp|docx|jpg|png)$')
```

### 2. Rate Limiting

```python
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)

@app.post("/analyze")
@limiter.limit("10/minute")  # IPë‹¹ ë¶„ë‹¹ 10íšŒ
async def analyze(request: Request):
    ...
```

### 3. ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹

```python
import re

def mask_personal_info(text: str) -> str:
    """ì£¼ë¯¼ë²ˆí˜¸, ì „í™”ë²ˆí˜¸ ë§ˆìŠ¤í‚¹"""
    # ì£¼ë¯¼ë²ˆí˜¸: 123456-1******
    text = re.sub(
        r'(\d{6})-(\d{7})',
        r'\1-*******',
        text
    )
    
    # ì „í™”ë²ˆí˜¸: 010-1234-****
    text = re.sub(
        r'(\d{2,3})-(\d{3,4})-(\d{4})',
        r'\1-\2-****',
        text
    )
    
    return text
```

---

<div align="center">
  <h2>ğŸ‰ ì•„í‚¤í…ì²˜ ë¬¸ì„œ ì™„ë£Œ!</h2>
  <p>ì´ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ êµ¬í˜„ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  <p>ê° ì»´í¬ë„ŒíŠ¸ë³„ ìƒì„¸ êµ¬í˜„ì€ ì½”ë“œ ì˜ˆì‹œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</p>
</div>
=======
# ê³µê³µë¬¸ì„œ AI ì„œë¹„ìŠ¤ - ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

> Option 2: ëª¨ë†€ë¦¬ì‹ + RAG ê¸°ë°˜ ì¤‘ê¸‰ììš© êµ¬í˜„ ê°€ì´ë“œ

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì „ì²´ ì•„í‚¤í…ì²˜](#ì „ì²´-ì•„í‚¤í…ì²˜)
3. [ë ˆì´ì–´ë³„ ìƒì„¸ êµ¬ì¡°](#ë ˆì´ì–´ë³„-ìƒì„¸-êµ¬ì¡°)
4. [ë°ì´í„° í”Œë¡œìš°](#ë°ì´í„°-í”Œë¡œìš°)
5. [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
6. [ë””ë ‰í† ë¦¬ êµ¬ì¡°](#ë””ë ‰í† ë¦¬-êµ¬ì¡°)
7. [ì£¼ìš” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„](#ì£¼ìš”-ì»´í¬ë„ŒíŠ¸-êµ¬í˜„)

---

## ì‹œìŠ¤í…œ ê°œìš”

### í•µì‹¬ ê¸°ëŠ¥
- ğŸ“„ ë¬¸ì„œ ì—…ë¡œë“œ ë° íŒŒì‹± (PDF, HWP, DOCX, ì´ë¯¸ì§€)
- ğŸ¤– AI ê¸°ë°˜ ìë™ ìš”ì•½
- ğŸ¯ í–‰ë™ ì•ˆë‚´ ì¶”ì¶œ (ë‚ ì§œ, ê¸ˆì•¡, ë°©ë²•)
- ğŸ’¬ ë¬¸ì„œ ê¸°ë°˜ Q&A ì±—ë´‡
- âš¡ Redis ìºì‹±
- ğŸ” RAG (ê²€ìƒ‰ ì¦ê°• ìƒì„±)

### ì²˜ë¦¬ ìš©ëŸ‰ ëª©í‘œ
- **ì‚¬ìš©ì**: 1,000 ~ 10,000ëª…
- **ë™ì‹œ ì ‘ì†**: 100ëª…
- **ë¬¸ì„œ ì²˜ë¦¬**: ì›” 10,000ê±´
- **í‰ê·  ì‘ë‹µ ì‹œê°„**: 3ì´ˆ ì´ë‚´

---

## ì „ì²´ ì•„í‚¤í…ì²˜

### High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Client Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Web App    â”‚  â”‚  Mobile App  â”‚  â”‚   Admin Dashboard    â”‚  â”‚
â”‚  â”‚  (React.js)  â”‚  â”‚(React Native)â”‚  â”‚      (Next.js)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS (REST API)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Application Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              FastAPI Application (Python)                  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  API Routes â”‚  â”‚  Middleware â”‚  â”‚  Error Handler  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   /upload   â”‚  â”‚   - CORS    â”‚  â”‚   - Logging     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  /analyze   â”‚  â”‚   - Auth    â”‚  â”‚   - Sentry      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    /chat    â”‚  â”‚   - RateL   â”‚  â”‚                 â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Service Layer                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Document   â”‚  â”‚      AI      â”‚  â”‚       Action         â”‚  â”‚
â”‚  â”‚   Parser     â”‚  â”‚   Service    â”‚  â”‚      Extractor       â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                      â”‚  â”‚
â”‚  â”‚ â€¢ PDF Parser â”‚  â”‚ â€¢ LLM Client â”‚  â”‚ â€¢ NER (ë‚ ì§œ/ê¸ˆì•¡)     â”‚  â”‚
â”‚  â”‚ â€¢ HWP Parser â”‚  â”‚ â€¢ RAG Engine â”‚  â”‚ â€¢ Regex Patterns     â”‚  â”‚
â”‚  â”‚ â€¢ OCR Engine â”‚  â”‚ â€¢ Embeddings â”‚  â”‚ â€¢ Entity Linking     â”‚  â”‚
â”‚  â”‚ â€¢ Image Pre  â”‚  â”‚ â€¢ Summarizer â”‚  â”‚                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Data Layer                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL   â”‚  â”‚    Redis     â”‚  â”‚      MinIO/S3        â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                      â”‚  â”‚
â”‚  â”‚ â€¢ Documents  â”‚  â”‚ â€¢ Cache      â”‚  â”‚ â€¢ Original Files     â”‚  â”‚
â”‚  â”‚ â€¢ Users      â”‚  â”‚ â€¢ Sessions   â”‚  â”‚ â€¢ Processed Files    â”‚  â”‚
â”‚  â”‚ â€¢ Analytics  â”‚  â”‚ â€¢ Queue      â”‚  â”‚                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Vector DB   â”‚  â”‚          External APIs               â”‚    â”‚
â”‚  â”‚  (Pinecone/  â”‚  â”‚                                      â”‚    â”‚
â”‚  â”‚   Weaviate)  â”‚  â”‚  â€¢ OpenAI GPT-4                      â”‚    â”‚
â”‚  â”‚              â”‚  â”‚  â€¢ OpenAI Embeddings                 â”‚    â”‚
â”‚  â”‚ â€¢ Embeddings â”‚  â”‚  â€¢ (Optional) HyperCLOVA X           â”‚    â”‚
â”‚  â”‚ â€¢ Chunks     â”‚  â”‚                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë ˆì´ì–´ë³„ ìƒì„¸ êµ¬ì¡°

### 1. Client Layer (í”„ë¡ íŠ¸ì—”ë“œ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Web Application (React)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Components:                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FileUploader.tsx                â”‚  â”‚
â”‚  â”‚  â€¢ Drag & Drop                   â”‚  â”‚
â”‚  â”‚  â€¢ File validation               â”‚  â”‚
â”‚  â”‚  â€¢ Progress bar                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AnalysisResult.tsx              â”‚  â”‚
â”‚  â”‚  â€¢ Summary display               â”‚  â”‚
â”‚  â”‚  â€¢ Action cards                  â”‚  â”‚
â”‚  â”‚  â€¢ Key points list               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ChatInterface.tsx               â”‚  â”‚
â”‚  â”‚  â€¢ Message list                  â”‚  â”‚
â”‚  â”‚  â€¢ Input box                     â”‚  â”‚
â”‚  â”‚  â€¢ Typing indicator              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  Services:                              â”‚
â”‚  â€¢ API Client (Axios)                   â”‚
â”‚  â€¢ State Management (Zustand/Redux)    â”‚
â”‚  â€¢ Error Handler                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. Application Layer (FastAPI)

#### 2.1 API Routes êµ¬ì¡°

```
app/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ v1/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”‚
â”‚       â”œâ”€â”€ documents.py  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚   POST /upload           â”‚  Document ê´€ë ¨
â”‚       â”‚   GET  /{id}             â”‚  ì—”ë“œí¬ì¸íŠ¸
â”‚       â”‚   DELETE /{id}           â”‚
â”‚       â”‚                          â”‚
â”‚       â”œâ”€â”€ analyze.py  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚   POST /analyze          â”‚  Analysis ê´€ë ¨
â”‚       â”‚   GET  /status/{id}      â”‚  ì—”ë“œí¬ì¸íŠ¸
â”‚       â”‚                          â”‚
â”‚       â””â”€â”€ chat.py  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚           POST /chat              â”‚  Chat ê´€ë ¨
â”‚           GET  /history/{id}      â”‚  ì—”ë“œí¬ì¸íŠ¸
```

#### 2.2 ë¯¸ë“¤ì›¨ì–´ íŒŒì´í”„ë¼ì¸

```
Request
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CORS Middleware â”‚  â†’ Origin ì²´í¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rate Limiter     â”‚  â†’ IPë‹¹ ìš”ì²­ ì œí•œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Authentication   â”‚  â†’ (Optional) JWT ê²€ì¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Request Logger   â”‚  â†’ ìš”ì²­ ë¡œê¹…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Route Handler    â”‚  â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error Handler    â”‚  â†’ ì—ëŸ¬ ì²˜ë¦¬ & ë¡œê¹…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
      Response
```

---

### 3. Service Layer ìƒì„¸

#### 3.1 Document Parser Service

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Document Parser Service              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  Input: File (PDF/HWP/DOCX/Image)           â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. File Type Detection                â”‚ â”‚
â”‚  â”‚     â€¢ MIME type check                  â”‚ â”‚
â”‚  â”‚     â€¢ Extension validation             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Parser Selection                   â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  if PDF:                               â”‚ â”‚
â”‚  â”‚    â†’ PDFParser (pdfplumber)            â”‚ â”‚
â”‚  â”‚       â€¢ Text extraction                â”‚ â”‚
â”‚  â”‚       â€¢ Table extraction               â”‚ â”‚
â”‚  â”‚       â€¢ Layout analysis                â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  elif HWP:                             â”‚ â”‚
â”‚  â”‚    â†’ HWPParser (olefile/pyhwp)         â”‚ â”‚
â”‚  â”‚       â€¢ Binary parsing                 â”‚ â”‚
â”‚  â”‚       â€¢ Text decoding (UTF-16)         â”‚ â”‚
â”‚  â”‚       â€¢ Structure parsing              â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  elif DOCX:                            â”‚ â”‚
â”‚  â”‚    â†’ DOCXParser (python-docx)          â”‚ â”‚
â”‚  â”‚       â€¢ XML parsing                    â”‚ â”‚
â”‚  â”‚       â€¢ Paragraph extraction           â”‚ â”‚
â”‚  â”‚       â€¢ Table extraction               â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  elif Image:                           â”‚ â”‚
â”‚  â”‚    â†’ OCREngine (Tesseract)             â”‚ â”‚
â”‚  â”‚       â€¢ Image preprocessing            â”‚ â”‚
â”‚  â”‚       â€¢ OCR (Korean + English)         â”‚ â”‚
â”‚  â”‚       â€¢ Confidence scoring             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Text Cleaning                      â”‚ â”‚
â”‚  â”‚     â€¢ Whitespace normalization         â”‚ â”‚
â”‚  â”‚     â€¢ Special character removal        â”‚ â”‚
â”‚  â”‚     â€¢ Encoding fix                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  Output: Clean Text + Metadata              â”‚
â”‚  {                                           â”‚
â”‚    "text": "...",                            â”‚
â”‚    "page_count": 3,                          â”‚
â”‚    "has_tables": true,                       â”‚
â”‚    "confidence": 0.95                        â”‚
â”‚  }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 AI Service (RAG Engine)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  RAG (Retrieval-Augmented Generation)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Phase 1: Document Processing                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Text Splitting                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Original Document (5000 chars)                  â”‚ â”‚
â”‚  â”‚            â†“                                         â”‚ â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
â”‚  â”‚     â”‚ Chunk Splitter  â”‚                             â”‚ â”‚
â”‚  â”‚     â”‚ (500 chars,     â”‚                             â”‚ â”‚
â”‚  â”‚     â”‚  50 overlap)    â”‚                             â”‚ â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
â”‚  â”‚              â†“                                       â”‚ â”‚
â”‚  â”‚     Chunk 1 (0-500)                                 â”‚ â”‚
â”‚  â”‚     Chunk 2 (450-950)                               â”‚ â”‚
â”‚  â”‚     Chunk 3 (900-1400)                              â”‚ â”‚
â”‚  â”‚     ...                                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Embedding Generation                             â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Each Chunk                                       â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     OpenAI Embeddings API                            â”‚ â”‚
â”‚  â”‚     (text-embedding-3-small)                         â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Vector [1536 dimensions]                         â”‚ â”‚
â”‚  â”‚     [0.123, -0.456, 0.789, ...]                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Vector Storage                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Vector Database (Pinecone/Weaviate)              â”‚ â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚     â”‚ document_id: "abc-123"               â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ chunk_index: 0                       â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ vector: [0.123, -0.456, ...]         â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ metadata: {                          â”‚        â”‚ â”‚
â”‚  â”‚     â”‚   page: 1,                           â”‚        â”‚ â”‚
â”‚  â”‚     â”‚   type: "ì„¸ê¸ˆê³ ì§€ì„œ"                  â”‚        â”‚ â”‚
â”‚  â”‚     â”‚ }                                    â”‚        â”‚ â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â”‚  Phase 2: Query Processing                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Query Embedding                                  â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     User Query: "ì–¸ì œê¹Œì§€ ë‚©ë¶€í•´ì•¼ í•´?"               â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     OpenAI Embeddings API                            â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Query Vector [1536 dimensions]                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Similarity Search                                â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Vector DB Search (Cosine Similarity)             â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Top 5 Most Similar Chunks:                       â”‚ â”‚
â”‚  â”‚     1. Chunk #7  (similarity: 0.92)                  â”‚ â”‚
â”‚  â”‚        "ë‚©ë¶€ ê¸°í•œì€ 2025ë…„ 10ì›” 20ì¼ê¹Œì§€..."           â”‚ â”‚
â”‚  â”‚     2. Chunk #3  (similarity: 0.87)                  â”‚ â”‚
â”‚  â”‚        "ë‚©ë¶€ ê¸ˆì•¡ì€ 130,000ì›ì…ë‹ˆë‹¤..."               â”‚ â”‚
â”‚  â”‚     ...                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Context Augmentation                             â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     Retrieved Chunks + Original Query                â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     Augmented Prompt:                                â”‚ â”‚
â”‚  â”‚     """                                              â”‚ â”‚
â”‚  â”‚     ë‹¤ìŒ ë¬¸ì„œ ë‚´ìš©ì„ ì°¸ê³ í•˜ì—¬ ì§ˆë¬¸ì— ë‹µí•˜ì„¸ìš”:          â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     ë¬¸ì„œ ë‚´ìš©:                                        â”‚ â”‚
â”‚  â”‚     - ë‚©ë¶€ ê¸°í•œì€ 2025ë…„ 10ì›” 20ì¼ê¹Œì§€...            â”‚ â”‚
â”‚  â”‚     - ë‚©ë¶€ ê¸ˆì•¡ì€ 130,000ì›ì…ë‹ˆë‹¤...                 â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     ì§ˆë¬¸: ì–¸ì œê¹Œì§€ ë‚©ë¶€í•´ì•¼ í•´?                       â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     ë‹µë³€:                                            â”‚ â”‚
â”‚  â”‚     """                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4. LLM Generation                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚     OpenAI GPT-4                                     â”‚ â”‚
â”‚  â”‚        â†“                                             â”‚ â”‚
â”‚  â”‚     "2025ë…„ 10ì›” 20ì¼ê¹Œì§€ ë‚©ë¶€í•˜ì…”ì•¼ í•©ë‹ˆë‹¤."         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3 Action Extractor Service

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Action Extractor Service             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  Input: Document Text                        â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Named Entity Recognition (NER)    â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Text: "2025ë…„ 10ì›” 20ì¼ê¹Œì§€ 130,000ì›  â”‚ â”‚
â”‚  â”‚         ì„ ì§€ë°©ì„¸ì…ê³„ì¢Œë¡œ ë‚©ë¶€í•˜ì„¸ìš”"    â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Regex Patterns:                       â”‚ â”‚
â”‚  â”‚  â€¢ Date:  \d{4}ë…„\s*\d{1,2}ì›”\s*\d{1,2}ì¼â”‚ â”‚
â”‚  â”‚  â€¢ Amount: \d{1,3}(,\d{3})*ì›           â”‚ â”‚
â”‚  â”‚  â€¢ Phone: \d{2,3}-\d{3,4}-\d{4}         â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Extracted:                            â”‚ â”‚
â”‚  â”‚  â€¢ DATE: "2025ë…„ 10ì›” 20ì¼"             â”‚ â”‚
â”‚  â”‚  â€¢ AMOUNT: "130,000ì›"                  â”‚ â”‚
â”‚  â”‚  â€¢ ACCOUNT: "ì§€ë°©ì„¸ì…ê³„ì¢Œ"              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. Normalization                      â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ Date â†’ ISO format                   â”‚ â”‚
â”‚  â”‚    "2025ë…„ 10ì›” 20ì¼" â†’ "2025-10-20"   â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ Amount â†’ Number                     â”‚ â”‚
â”‚  â”‚    "130,000ì›" â†’ 130000                â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ Phone â†’ Standard format             â”‚ â”‚
â”‚  â”‚    "02-123-4567" â†’ "02-123-4567"       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Relationship Extraction            â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Link entities:                        â”‚ â”‚
â”‚  â”‚  â€¢ deadline â† DATE                     â”‚ â”‚
â”‚  â”‚  â€¢ amount â† AMOUNT                     â”‚ â”‚
â”‚  â”‚  â€¢ method â† ACCOUNT                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4. Action Builder                     â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Template:                             â”‚ â”‚
â”‚  â”‚  "{method}ë¡œ {amount}ì›ì„               â”‚ â”‚
â”‚  â”‚   {deadline}ê¹Œì§€ ë‚©ë¶€í•˜ì„¸ìš”"            â”‚ â”‚
â”‚  â”‚                                        â”‚ â”‚
â”‚  â”‚  Result:                               â”‚ â”‚
â”‚  â”‚  "ì§€ë°©ì„¸ì…ê³„ì¢Œë¡œ 130,000ì›ì„             â”‚ â”‚
â”‚  â”‚   2025-10-20ê¹Œì§€ ë‚©ë¶€í•˜ì„¸ìš”"            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚  Output: Structured Action                   â”‚
â”‚  {                                           â”‚
â”‚    "deadline": "2025-10-20",                 â”‚
â”‚    "amount": 130000,                         â”‚
â”‚    "action": "...",                          â”‚
â”‚    "method": "ì§€ë°©ì„¸ì…ê³„ì¢Œ"                   â”‚
â”‚  }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë°ì´í„° í”Œë¡œìš°

### ì „ì²´ ìš”ì²­ íë¦„ (Upload â†’ Analyze)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ 1. íŒŒì¼ ì„ íƒ
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend (React)                    â”‚
â”‚                                             â”‚
â”‚  â€¢ File validation (í¬ê¸°, í˜•ì‹)              â”‚
â”‚  â€¢ FormData ìƒì„±                             â”‚
â”‚  â€¢ Progress bar í‘œì‹œ                         â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 2. POST /documents/upload
     â”‚    (multipart/form-data)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      API Gateway (FastAPI)                  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Middleware Pipeline                   â”‚ â”‚
â”‚  â”‚  1. CORS check                         â”‚ â”‚
â”‚  â”‚  2. Rate limit (IPë‹¹ 100req/hour)      â”‚ â”‚
â”‚  â”‚  3. Request logging                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 3. documents.upload_handler()
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Document Service                       â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Validation                         â”‚ â”‚
â”‚  â”‚     â€¢ File size < 10MB?                â”‚ â”‚
â”‚  â”‚     â€¢ Extension in allowed list?       â”‚ â”‚
â”‚  â”‚     â€¢ MIME type check                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2. File Storage                       â”‚ â”‚
â”‚  â”‚     â€¢ Generate UUID                    â”‚ â”‚
â”‚  â”‚     â€¢ Save to /tmp/uploads/{uuid}.ext  â”‚ â”‚
â”‚  â”‚     â€¢ (Optional) Upload to S3          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3. Database Record                    â”‚ â”‚
â”‚  â”‚     INSERT INTO documents              â”‚ â”‚
â”‚  â”‚       (id, filename, path, status)     â”‚ â”‚
â”‚  â”‚     VALUES (uuid, name, path, 'uploaded')â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 4. Return document_id
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend                            â”‚
â”‚                                             â”‚
â”‚  â€¢ Store document_id                        â”‚
â”‚  â€¢ Enable "ë¶„ì„í•˜ê¸°" button                  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 5. User clicks "ë¶„ì„í•˜ê¸°"
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend                            â”‚
â”‚                                             â”‚
â”‚  â€¢ Show loading spinner                     â”‚
â”‚  â€¢ POST /analyze { document_id }            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 6. POST /analyze
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      API Gateway                            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 7. analyze.analyze_handler()
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Analysis Orchestrator                  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 1: Load Document                 â”‚ â”‚
â”‚  â”‚  â€¢ SELECT * FROM documents             â”‚ â”‚
â”‚  â”‚    WHERE id = {document_id}            â”‚ â”‚
â”‚  â”‚  â€¢ Check status != 'processing'        â”‚ â”‚
â”‚  â”‚  â€¢ UPDATE status = 'processing'        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 2: Cache Check                   â”‚ â”‚
â”‚  â”‚  â€¢ hash = md5(file_content)            â”‚ â”‚
â”‚  â”‚  â€¢ cached = redis.get(f"doc:{hash}")   â”‚ â”‚
â”‚  â”‚  â€¢ if cached: return cached            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“ (cache miss)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 3: Parse Document                â”‚ â”‚
â”‚  â”‚  â€¢ DocumentParser.parse(file_path)     â”‚ â”‚
â”‚  â”‚  â€¢ Get clean text                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 4: RAG Processing                â”‚ â”‚
â”‚  â”‚  â€¢ Split text into chunks              â”‚ â”‚
â”‚  â”‚  â€¢ Generate embeddings                 â”‚ â”‚
â”‚  â”‚  â€¢ Store in vector DB                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 5: LLM Analysis                  â”‚ â”‚
â”‚  â”‚  Parallel execution:                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Summarize  â”‚  â”‚ Extract Actions  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ (GPT-4)    â”‚  â”‚ (NER + GPT)      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Step 6: Save Results                  â”‚ â”‚
â”‚  â”‚  â€¢ UPDATE documents SET                â”‚ â”‚
â”‚  â”‚      analysis_result = {result},       â”‚ â”‚
â”‚  â”‚      status = 'completed'              â”‚ â”‚
â”‚  â”‚  â€¢ redis.set(cache_key, result, ex=86400)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ 8. Return analysis result
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend                            â”‚
â”‚                                             â”‚
â”‚  â€¢ Hide loading spinner                     â”‚
â”‚  â€¢ Display summary                          â”‚
â”‚  â€¢ Show action cards                        â”‚
â”‚  â€¢ Enable chat interface                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì±—ë´‡ ëŒ€í™” í”Œë¡œìš°

```
User Question: "ì–¸ì œê¹Œì§€ ë‚©ë¶€í•´ì•¼ í•´?"
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend (Chat Interface)      â”‚
â”‚  â€¢ Add message to chat history  â”‚
â”‚  â€¢ POST /chat                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chat Service                   â”‚
â”‚                                 â”‚
â”‚  1. Question Embedding          â”‚
â”‚     â†“                           â”‚
â”‚  2. Vector Similarity Search    â”‚
â”‚     Query Vector DB             â”‚
â”‚     â†“                           â”‚
â”‚  3. Get Top 5 Relevant Chunks   â”‚
â”‚     Chunk #7: "ë‚©ë¶€ ê¸°í•œì€..."   â”‚
â”‚     Chunk #3: "ë‚©ë¶€ ê¸ˆì•¡ì€..."   â”‚
â”‚     â†“                           â”‚
â”‚  4. Build Augmented Prompt      â”‚
â”‚     Context: [chunks]           â”‚
â”‚     History: [past messages]    â”‚
â”‚     Question: "ì–¸ì œê¹Œì§€..."      â”‚
â”‚     â†“                           â”‚
â”‚  5. LLM Generation (GPT-4)      â”‚
â”‚     â†“                           â”‚
â”‚  6. Answer with Source          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
      Response
      {
        "answer": "2025ë…„ 10ì›” 20ì¼ê¹Œì§€...",
        "source": "document",
        "confidence": 0.95
      }
```

---

## ê¸°ìˆ  ìŠ¤íƒ

### Backend Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Backend Layer                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  Framework:                              â”‚
â”‚  â€¢ FastAPI 0.104+         (Web Framework)â”‚
â”‚  â€¢ Pydantic 2.0+          (Validation)   â”‚
â”‚  â€¢ Uvicorn                (ASGI Server)  â”‚
â”‚                                          â”‚
â”‚  Document Processing:                    â”‚
â”‚  â€¢ pdfplumber             (PDF parsing)  â”‚
â”‚  â€¢ python-docx            (DOCX parsing) â”‚
â”‚  â€¢ olefile / pyhwp        (HWP parsing)  â”‚
â”‚  â€¢ pytesseract            (OCR)          â”‚
â”‚  â€¢ Pillow, OpenCV         (Image proc)   â”‚
â”‚                                          â”‚
â”‚  AI/ML:                                  â”‚
â”‚  â€¢ openai 1.0+            (GPT-4 API)    â”‚
â”‚  â€¢ langchain 0.1+         (RAG framework)â”‚
â”‚  â€¢ sentence-transformers  (Embeddings)   â”‚
â”‚  â€¢ tiktoken               (Token count)  â”‚
â”‚                                          â”‚
â”‚  Database:                               â”‚
â”‚  â€¢ SQLAlchemy 2.0+        (ORM)          â”‚
â”‚  â€¢ psycopg2-binary        (PostgreSQL)   â”‚
â”‚  â€¢ redis                  (Caching)      â”‚
â”‚  â€¢ pinecone-client        (Vector DB)    â”‚
â”‚                                          â”‚
â”‚  Utilities:                              â”‚
â”‚  â€¢ python-multipart       (File upload)  â”‚
â”‚  â€¢ python-jose            (JWT)          â”‚
â”‚  â€¢ passlib                (Password hash)â”‚
â”‚  â€¢ python-dotenv          (Env vars)     â”‚
â”‚  â€¢ aiofiles               (Async I/O)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Infrastructure Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Infrastructure                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  Databases:                              â”‚
â”‚  â€¢ PostgreSQL 15          (Main DB)      â”‚
â”‚  â€¢ Redis 7                (Cache/Queue)  â”‚
â”‚  â€¢ Pinecone / Weaviate    (Vector DB)    â”‚
â”‚                                          â”‚
â”‚  Storage:                                â”‚
â”‚  â€¢ Local FS / MinIO       (Dev)          â”‚
â”‚  â€¢ AWS S3 / GCS           (Production)   â”‚
â”‚                                          â”‚
â”‚  Deployment:                             â”‚
â”‚  â€¢ Docker                 (Containerize) â”‚
â”‚  â€¢ Docker Compose         (Orchestration)â”‚
â”‚  â€¢ Nginx                  (Reverse proxy)â”‚
â”‚                                          â”‚
â”‚  Monitoring:                             â”‚
â”‚  â€¢ Sentry                 (Error track)  â”‚
â”‚  â€¢ Prometheus             (Metrics)      â”‚
â”‚  â€¢ Grafana                (Visualization)â”‚
â”‚                                          â”‚
â”‚  CI/CD:                                  â”‚
â”‚  â€¢ GitHub Actions         (CI/CD)        â”‚
â”‚  â€¢ Pre-commit             (Git hooks)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

### ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
doc-ai-backend/
â”‚
â”œâ”€â”€ app/                          # ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                   # FastAPI ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ config.py                 # ì„¤ì • (í™˜ê²½ë³€ìˆ˜ ë“±)
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                      # API ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ deps.py               # ê³µí†µ ì˜ì¡´ì„±
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ documents.py      # ë¬¸ì„œ ì—…ë¡œë“œ/ì¡°íšŒ
â”‚   â”‚       â”œâ”€â”€ analyze.py        # ë¬¸ì„œ ë¶„ì„
â”‚   â”‚       â””â”€â”€ chat.py           # ì±—ë´‡ Q&A
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                     # í•µì‹¬ ê¸°ëŠ¥
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ security.py           # ì¸ì¦/ë³´ì•ˆ
â”‚   â”‚   â”œâ”€â”€ middleware.py         # ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â””â”€â”€ exceptions.py         # ì»¤ìŠ¤í…€ ì˜ˆì™¸
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ document_parser/     # ë¬¸ì„œ íŒŒì‹±
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py          # ì¶”ìƒ í´ë˜ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ pdf_parser.py
â”‚   â”‚   â”‚   â”œâ”€â”€ hwp_parser.py
â”‚   â”‚   â”‚   â”œâ”€â”€ docx_parser.py
â”‚   â”‚   â”‚   â””â”€â”€ image_parser.py  # OCR
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ llm/                  # LLM ê´€ë ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ client.py        # OpenAI í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts.py       # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚   â”‚   â”‚   â””â”€â”€ smart_router.py  # ëª¨ë¸ ì„ íƒ ë¡œì§
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ rag/                  # RAG ì‹œìŠ¤í…œ
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ embeddings.py    # ì„ë² ë”© ìƒì„±
â”‚   â”‚   â”‚   â”œâ”€â”€ vector_store.py  # ë²¡í„° DB ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ retriever.py     # ê²€ìƒ‰ ë¡œì§
â”‚   â”‚   â”‚   â””â”€â”€ chain.py         # RAG ì²´ì¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ extractor/            # ì •ë³´ ì¶”ì¶œ
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ner.py           # NER (ê°œì²´ëª… ì¸ì‹)
â”‚   â”‚   â”‚   â”œâ”€â”€ patterns.py      # Regex íŒ¨í„´
â”‚   â”‚   â”‚   â””â”€â”€ action_builder.py
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ cache/                # ìºì‹±
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ redis_cache.py
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                   # DB ëª¨ë¸ (SQLAlchemy)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                  # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â”œâ”€â”€ analyze.py
â”‚   â”‚   â””â”€â”€ chat.py
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                       # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â””â”€â”€ session.py
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ file_handler.py
â”‚       â”œâ”€â”€ hash.py
â”‚       â””â”€â”€ logger.py
â”‚
â”œâ”€â”€ tests/                        # í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py               # pytest ì„¤ì •
â”‚   â”œâ”€â”€ test_api/
â”‚   â”‚   â”œâ”€â”€ test_documents.py
â”‚   â”‚   â”œâ”€â”€ test_analyze.py
â”‚   â”‚   â””â”€â”€ test_chat.py
â”‚   â”œâ”€â”€ test_services/
â”‚   â”‚   â”œâ”€â”€ test_parser.py
â”‚   â”‚   â”œâ”€â”€ test_llm.py
â”‚   â”‚   â””â”€â”€ test_rag.py
â”‚   â””â”€â”€ fixtures/
â”‚       â”œâ”€â”€ sample.pdf
â”‚       â”œâ”€â”€ sample.hwp
â”‚       â””â”€â”€ sample.jpg
â”‚
â”œâ”€â”€ alembic/                      # DB ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ versions/
â”‚   â”œâ”€â”€ env.py
â”‚   â””â”€â”€ alembic.ini
â”‚
â”œâ”€â”€ scripts/                      # ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ init_db.py
â”‚   â”œâ”€â”€ seed_data.py
â”‚   â””â”€â”€ migrate.sh
â”‚
â”œâ”€â”€ docs/                         # ë¬¸ì„œ
â”‚   â”œâ”€â”€ API_SPECIFICATION.md
â”‚   â”œâ”€â”€ ARCHITECTURE.md
â”‚   â””â”€â”€ DEPLOYMENT.md
â”‚
â”œâ”€â”€ .github/                      # GitHub Actions
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml
â”‚       â””â”€â”€ deploy.yml
â”‚
â”œâ”€â”€ docker/                       # Docker íŒŒì¼
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ Dockerfile.dev
â”‚   â””â”€â”€ nginx.conf
â”‚
â”œâ”€â”€ .env.example                  # í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ .gitignore
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ docker-compose.dev.yml
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ requirements-dev.txt
â”œâ”€â”€ pyproject.toml               # Python í”„ë¡œì íŠ¸ ì„¤ì •
â”œâ”€â”€ pytest.ini
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE
```

---

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

### 1. main.py (FastAPI ì•±)

```python
# app/main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager

from app.config import settings
from app.api.v1 import documents, analyze, chat
from app.core.middleware import LoggingMiddleware, RateLimitMiddleware
from app.db.session import engine
from app.models.base import Base


@asynccontextmanager
async def lifespan(app: FastAPI):
    """ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘/ì¢…ë£Œ ì´ë²¤íŠ¸"""
    # Startup
    print("ğŸš€ Starting application...")
    # DB í…Œì´ë¸” ìƒì„± (í”„ë¡œë•ì…˜ì—ì„œëŠ” Alembic ì‚¬ìš©)
    Base.metadata.create_all(bind=engine)
    
    yield
    
    # Shutdown
    print("ğŸ‘‹ Shutting down application...")


# FastAPI ì•± ìƒì„±
app = FastAPI(
    title=settings.PROJECT_NAME,
    version="1.0.0",
    openapi_url=f"{settings.API_V1_STR}/openapi.json",
    lifespan=lifespan
)

# CORS ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.ALLOWED_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# ì»¤ìŠ¤í…€ ë¯¸ë“¤ì›¨ì–´
app.add_middleware(LoggingMiddleware)
app.add_middleware(RateLimitMiddleware)

# ë¼ìš°í„° ë“±ë¡
app.include_router(
    documents.router,
    prefix=f"{settings.API_V1_STR}/documents",
    tags=["documents"]
)
app.include_router(
    analyze.router,
    prefix=f"{settings.API_V1_STR}",
    tags=["analyze"]
)
app.include_router(
    chat.router,
    prefix=f"{settings.API_V1_STR}",
    tags=["chat"]
)


@app.get("/health")
async def health_check():
    """í—¬ìŠ¤ ì²´í¬"""
    return {
        "status": "healthy",
        "version": "1.0.0"
    }


if __name__ == "__main__":
    import uvicorn
    uvicorn.run(
        "app.main:app",
        host="0.0.0.0",
        port=8000,
        reload=True
    )
```

### 2. config.py (í™˜ê²½ ì„¤ì •)

```python
# app/config.py
from pydantic_settings import BaseSettings
from typing import List


class Settings(BaseSettings):
    # API
    PROJECT_NAME: str = "Public Document AI"
    API_V1_STR: str = "/api/v1"
    ALLOWED_ORIGINS: List[str] = ["http://localhost:3000", "http://localhost:3001"]
    
    # OpenAI
    OPENAI_API_KEY: str
    OPENAI_MODEL_DEFAULT: str = "gpt-4o-mini"
    OPENAI_MODEL_PREMIUM: str = "gpt-4o"
    
    # Database
    DATABASE_URL: str = "postgresql://postgres:password@localhost:5432/docai"
    
    # Redis
    REDIS_URL: str = "redis://localhost:6379"
    
    # Vector DB
    PINECONE_API_KEY: str = ""
    PINECONE_ENVIRONMENT: str = ""
    PINECONE_INDEX: str = "doc-embeddings"
    
    # File Upload
    UPLOAD_DIR: str = "/tmp/uploads"
    MAX_FILE_SIZE: int = 10 * 1024 * 1024  # 10MB
    ALLOWED_EXTENSIONS: set = {".pdf", ".hwp", ".docx", ".jpg", ".jpeg", ".png"}
    
    # Cache
    CACHE_TTL: int = 86400  # 24 hours
    
    # Logging
    LOG_LEVEL: str = "INFO"
    
    # Sentry (Optional)
    SENTRY_DSN: str = ""
    
    class Config:
        env_file = ".env"
        case_sensitive = True


settings = Settings()
```

### 3. Document Parser Service

```python
# app/services/document_parser/pdf_parser.py
import pdfplumber
from typing import Dict, Any
from pathlib import Path


class PDFParser:
    """PDF ë¬¸ì„œ íŒŒì„œ"""
    
    async def parse(self, file_path: str) -> Dict[str, Any]:
        """
        PDF íŒŒì¼ì„ íŒŒì‹±í•˜ì—¬ í…ìŠ¤íŠ¸ ì¶”ì¶œ
        
        Args:
            file_path: PDF íŒŒì¼ ê²½ë¡œ
            
        Returns:
            {
                "text": "ì¶”ì¶œëœ í…ìŠ¤íŠ¸",
                "page_count": 3,
                "has_tables": True,
                "tables": [...]
            }
        """
        text = ""
        tables = []
        
        with pdfplumber.open(file_path) as pdf:
            page_count = len(pdf.pages)
            
            for page_num, page in enumerate(pdf.pages, 1):
                # í…ìŠ¤íŠ¸ ì¶”ì¶œ
                page_text = page.extract_text()
                if page_text:
                    text += f"\n--- Page {page_num} ---\n"
                    text += page_text
                
                # í‘œ ì¶”ì¶œ
                page_tables = page.extract_tables()
                if page_tables:
                    for table in page_tables:
                        tables.append({
                            "page": page_num,
                            "data": table
                        })
                        
                        # í‘œë¥¼ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ì¶”ê°€
                        for row in table:
                            if row:
                                text += "\n" + " | ".join([str(cell) if cell else "" for cell in row])
        
        return {
            "text": text.strip(),
            "page_count": page_count,
            "has_tables": len(tables) > 0,
            "tables": tables,
            "metadata": {
                "format": "pdf",
                "parser": "pdfplumber"
            }
        }
```

### 4. RAG Engine

```python
# app/services/rag/chain.py
from typing import Dict, Any, List
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings, ChatOpenAI
from langchain_community.vectorstores import Pinecone as LangchainPinecone
from langchain.chains import RetrievalQA
import pinecone

from app.config import settings


class RAGEngine:
    """RAG (ê²€ìƒ‰ ì¦ê°• ìƒì„±) ì—”ì§„"""
    
    def __init__(self):
        # Embeddings ëª¨ë¸
        self.embeddings = OpenAIEmbeddings(
            openai_api_key=settings.OPENAI_API_KEY,
            model="text-embedding-3-small"
        )
        
        # Pinecone ì´ˆê¸°í™”
        pinecone.init(
            api_key=settings.PINECONE_API_KEY,
            environment=settings.PINECONE_ENVIRONMENT
        )
        
        # Vector Store
        self.vector_store = LangchainPinecone(
            index_name=settings.PINECONE_INDEX,
            embedding=self.embeddings
        )
        
        # LLM
        self.llm = ChatOpenAI(
            openai_api_key=settings.OPENAI_API_KEY,
            model_name=settings.OPENAI_MODEL_DEFAULT,
            temperature=0.3
        )
    
    async def process_document(
        self, 
        text: str, 
        document_id: str
    ) -> None:
        """
        ë¬¸ì„œë¥¼ ì²˜ë¦¬í•˜ì—¬ Vector DBì— ì €ì¥
        
        Args:
            text: ë¬¸ì„œ í…ìŠ¤íŠ¸
            document_id: ë¬¸ì„œ ID
        """
        # 1. í…ìŠ¤íŠ¸ ë¶„í• 
        text_splitter = RecursiveCharacterTextSplitter(
            chunk_size=500,
            chunk_overlap=50,
            length_function=len,
        )
        chunks = text_splitter.split_text(text)
        
        # 2. ë©”íƒ€ë°ì´í„° ì¶”ê°€
        documents = []
        for i, chunk in enumerate(chunks):
            documents.append({
                "text": chunk,
                "metadata": {
                    "document_id": document_id,
                    "chunk_index": i,
                    "total_chunks": len(chunks)
                }
            })
        
        # 3. Vector DBì— ì €ì¥
        texts = [doc["text"] for doc in documents]
        metadatas = [doc["metadata"] for doc in documents]
        
        self.vector_store.add_texts(
            texts=texts,
            metadatas=metadatas
        )
    
    async def query(
        self, 
        question: str,
        document_id: str,
        k: int = 5
    ) -> Dict[str, Any]:
        """
        ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ ìƒì„±
        
        Args:
            question: ì‚¬ìš©ì ì§ˆë¬¸
            document_id: ë¬¸ì„œ ID
            k: ê²€ìƒ‰í•  chunk ê°œìˆ˜
            
        Returns:
            {
                "answer": "ë‹µë³€",
                "sources": [...],
                "confidence": 0.95
            }
        """
        # 1. Retriever ìƒì„± (íŠ¹ì • ë¬¸ì„œë§Œ ê²€ìƒ‰)
        retriever = self.vector_store.as_retriever(
            search_kwargs={
                "k": k,
                "filter": {"document_id": document_id}
            }
        )
        
        # 2. QA Chain ìƒì„±
        qa_chain = RetrievalQA.from_chain_type(
            llm=self.llm,
            chain_type="stuff",
            retriever=retriever,
            return_source_documents=True
        )
        
        # 3. ì§ˆë¬¸ ì‹¤í–‰
        result = qa_chain.invoke({"query": question})
        
        # 4. ì‹ ë¢°ë„ ê³„ì‚° (ê°„ë‹¨í•œ íœ´ë¦¬ìŠ¤í‹±)
        confidence = self._calculate_confidence(
            result["source_documents"]
        )
        
        return {
            "answer": result["result"],
            "sources": [
                {
                    "text": doc.page_content,
                    "chunk_index": doc.metadata["chunk_index"]
                }
                for doc in result["source_documents"]
            ],
            "confidence": confidence
        }
    
    def _calculate_confidence(
        self, 
        source_docs: List
    ) -> float:
        """ì‹ ë¢°ë„ ê³„ì‚°"""
        if not source_docs:
            return 0.0
        
        # ê²€ìƒ‰ëœ ë¬¸ì„œê°€ ë§ì„ìˆ˜ë¡ ì‹ ë¢°ë„ ë†’ìŒ
        # ê°„ë‹¨í•œ íœ´ë¦¬ìŠ¤í‹±: min(ê²€ìƒ‰ëœ ë¬¸ì„œ ìˆ˜ / 5, 1.0)
        return min(len(source_docs) / 5.0, 1.0)
```

### 5. API Route ì˜ˆì‹œ

```python
# app/api/v1/analyze.py
from fastapi import APIRouter, HTTPException, Depends, BackgroundTasks
from sqlalchemy.orm import Session
import json

from app.db.session import get_db
from app.models.document import Document
from app.services.document_parser import DocumentParserFactory
from app.services.llm.client import LLMClient
from app.services.rag.chain import RAGEngine
from app.services.extractor.action_builder import ActionExtractor
from app.services.cache.redis_cache import RedisCache
from app.schemas.analyze import AnalyzeRequest, AnalyzeResponse


router = APIRouter()
rag_engine = RAGEngine()
llm_client = LLMClient()
action_extractor = ActionExtractor()
cache = RedisCache()


@router.post("/analyze", response_model=AnalyzeResponse)
async def analyze_document(
    request: AnalyzeRequest,
    background_tasks: BackgroundTasks,
    db: Session = Depends(get_db)
):
    """
    ë¬¸ì„œ ë¶„ì„
    
    1. ë¬¸ì„œ ì¡°íšŒ
    2. ìºì‹œ í™•ì¸
    3. íŒŒì‹±
    4. RAG ì²˜ë¦¬
    5. LLM ë¶„ì„
    6. ê²°ê³¼ ì €ì¥
    """
    
    # 1. ë¬¸ì„œ ì¡°íšŒ
    document = db.query(Document).filter(
        Document.id == request.document_id
    ).first()
    
    if not document:
        raise HTTPException(
            status_code=404,
            detail={
                "error": "ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
                "code": "DOCUMENT_NOT_FOUND"
            }
        )
    
    # 2. ìºì‹œ í™•ì¸
    with open(document.file_path, 'rb') as f:
        file_content = f.read()
    
    cache_key = cache.generate_key(file_content)
    cached_result = await cache.get(cache_key)
    
    if cached_result:
        return AnalyzeResponse(**cached_result)
    
    # 3. ìƒíƒœ ì—…ë°ì´íŠ¸
    document.status = "processing"
    db.commit()
    
    try:
        # 4. ë¬¸ì„œ íŒŒì‹±
        parser = DocumentParserFactory.get_parser(document.file_type)
        parsed = await parser.parse(document.file_path)
        text = parsed["text"]
        
        # 5. RAG ì²˜ë¦¬ (ë°±ê·¸ë¼ìš´ë“œ)
        background_tasks.add_task(
            rag_engine.process_document,
            text,
            document.id
        )
        
        # 6. LLM ë¶„ì„ (ë³‘ë ¬)
        import asyncio
        
        summary_task = llm_client.summarize(text)
        actions_task = action_extractor.extract(text)
        
        summary, actions = await asyncio.gather(
            summary_task,
            actions_task
        )
        
        # 7. ê²°ê³¼ ì¡°í•©
        result = {
            "document_id": document.id,
            "summary": summary["summary"],
            "document_type": summary["document_type"],
            "importance": summary["importance"],
            "key_points": summary["key_points"],
            "actions": actions,
            "metadata": {
                "tokens_used": summary.get("tokens_used", 0),
                "model_used": summary.get("model_used", ""),
                "processing_time": 0  # TODO: ì‹¤ì œ ì‹œê°„ ì¸¡ì •
            }
        }
        
        # 8. DB ì €ì¥
        document.status = "completed"
        document.analysis_result = json.dumps(result, ensure_ascii=False)
        document.extracted_text = text
        db.commit()
        
        # 9. ìºì‹œ ì €ì¥ (24ì‹œê°„)
        await cache.set(cache_key, result, ttl=86400)
        
        return AnalyzeResponse(**result)
        
    except Exception as e:
        # ì—ëŸ¬ ì²˜ë¦¬
        document.status = "failed"
        document.error_message = str(e)
        db.commit()
        
        raise HTTPException(
            status_code=500,
            detail={
                "error": "ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",
                "code": "ANALYSIS_FAILED"
            }
        )
```

---

## ì„±ëŠ¥ ìµœì í™” í¬ì¸íŠ¸

### 1. ìºì‹± ì „ëµ

```python
# 3ë‹¨ê³„ ìºì‹±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Application     â”‚  â†’ Redis (ë¶„ì„ ê²°ê³¼)
â”‚     Cache           â”‚     TTL: 24ì‹œê°„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Database        â”‚  â†’ PostgreSQL 
â”‚     Query Cache     â”‚     (ORM ë ˆë²¨)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. CDN Cache       â”‚  â†’ CloudFlare
â”‚     (Static files)  â”‚     (ì´ë¯¸ì§€, CSS, JS)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ë¹„ë™ê¸° ì²˜ë¦¬

```python
# ë³‘ë ¬ ì²˜ë¦¬ë¡œ ì†ë„ í–¥ìƒ
import asyncio

async def analyze_document(text):
    # ë™ì‹œ ì‹¤í–‰
    summary, actions, embeddings = await asyncio.gather(
        summarize(text),      # 3ì´ˆ
        extract_actions(text), # 2ì´ˆ
        generate_embeddings(text) # 4ì´ˆ
    )
    # ì´ ì†Œìš” ì‹œê°„: 4ì´ˆ (ìµœëŒ€ê°’)
    # vs ìˆœì°¨ ì‹¤í–‰: 9ì´ˆ
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤

```sql
-- ìì£¼ ì¡°íšŒë˜ëŠ” ì»¬ëŸ¼ ì¸ë±ìŠ¤
CREATE INDEX idx_document_status ON documents(status);
CREATE INDEX idx_document_created ON documents(created_at DESC);

-- ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX idx_document_status_created 
ON documents(status, created_at DESC);
```

---

## ëª¨ë‹ˆí„°ë§ & ë¡œê¹…

### ë¡œê¹… êµ¬ì¡°

```python
# app/utils/logger.py
import logging
from pythonjsonlogger import jsonlogger

# JSON í˜•ì‹ ë¡œê·¸
logHandler = logging.StreamHandler()
formatter = jsonlogger.JsonFormatter(
    '%(timestamp)s %(level)s %(name)s %(message)s'
)
logHandler.setFormatter(formatter)

logger = logging.getLogger()
logger.addHandler(logHandler)
logger.setLevel(logging.INFO)

# ì‚¬ìš©
logger.info(
    "Document analyzed",
    extra={
        "document_id": "abc-123",
        "processing_time": 3.2,
        "tokens_used": 1250
    }
)
```

### ë©”íŠ¸ë¦­ ìˆ˜ì§‘

```python
# Prometheus ë©”íŠ¸ë¦­
from prometheus_client import Counter, Histogram

# ìš”ì²­ ì¹´ìš´í„°
request_count = Counter(
    'api_requests_total',
    'Total API requests',
    ['method', 'endpoint', 'status']
)

# ì²˜ë¦¬ ì‹œê°„ íˆìŠ¤í† ê·¸ë¨
processing_time = Histogram(
    'document_processing_seconds',
    'Document processing time'
)

# ì‚¬ìš©
with processing_time.time():
    result = await analyze_document(doc_id)
```

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. ì…ë ¥ ê²€ì¦

```python
# Pydanticìœ¼ë¡œ ìë™ ê²€ì¦
class UploadFile(BaseModel):
    filename: str = Field(..., max_length=255)
    file_size: int = Field(..., le=10*1024*1024)  # 10MB
    file_type: str = Field(..., regex=r'\.(pdf|hwp|docx|jpg|png)$')
```

### 2. Rate Limiting

```python
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)

@app.post("/analyze")
@limiter.limit("10/minute")  # IPë‹¹ ë¶„ë‹¹ 10íšŒ
async def analyze(request: Request):
    ...
```

### 3. ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹

```python
import re

def mask_personal_info(text: str) -> str:
    """ì£¼ë¯¼ë²ˆí˜¸, ì „í™”ë²ˆí˜¸ ë§ˆìŠ¤í‚¹"""
    # ì£¼ë¯¼ë²ˆí˜¸: 123456-1******
    text = re.sub(
        r'(\d{6})-(\d{7})',
        r'\1-*******',
        text
    )
    
    # ì „í™”ë²ˆí˜¸: 010-1234-****
    text = re.sub(
        r'(\d{2,3})-(\d{3,4})-(\d{4})',
        r'\1-\2-****',
        text
    )
    
    return text
```

---

<div align="center">
  <h2>ğŸ‰ ì•„í‚¤í…ì²˜ ë¬¸ì„œ ì™„ë£Œ!</h2>
  <p>ì´ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì œ êµ¬í˜„ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  <p>ê° ì»´í¬ë„ŒíŠ¸ë³„ ìƒì„¸ êµ¬í˜„ì€ ì½”ë“œ ì˜ˆì‹œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</p>
</div>
>>>>>>> eddc8028aa02bf9e08f64256085011fe6426ad2a
